<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>修改密码</title>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <script src="/static/js/jquery-3.3.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js" ></script>

    <!-- Bootstrap -->
    <link href="/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="/vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="/build/css/custom.min.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
    <!-- bootstrap-wysiwyg -->
    <link href="/vendors/google-code-prettify/bin/prettify.min.css" rel="stylesheet">
    <!-- Select2 -->
    <link href="/vendors/select2/dist/css/select2.min.css" rel="stylesheet">
    <!-- Switchery -->
    <link href="/vendors/switchery/dist/switchery.min.css" rel="stylesheet">
    <!-- starrr -->
    <link href="/vendors/starrr/dist/starrr.css" rel="stylesheet">
    <!-- bootstrap-daterangepicker -->
    <link href="/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="/build/css/custom.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="/vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="/vendors/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <script type="text/javascript">
        $(function () {
            $("#btn_01").click(function (e) {
                e.preventDefault();
                if(checkUserPassword()&&checkNewPassword()&&confirmPassword()){
                    var confirMsg=confirm("确定修改？")
                    if (confirMsg){
                        $.post("/api/user/modifyPassword",$("#form_01").serialize(),function (data) {
                            if(data.code==3107){
                                $("#errorMsg").text(data.msg)
                                //修改成功跳转
                                    window.location.href="/pages/user/login.html";
                            }else {
                                $("#errorMsg").text(data.msg)
                                //注册失败，返回注册失败信息；
                            }

                        },"json");
                    }
                }

            })
        })
        function checkUserPassword() {
            var oldpasswordtext = $("#userPassword").val();
            var oldpasswordpatt= /^\w{6,12}$/;
            if(!oldpasswordpatt.test(oldpasswordtext)){
                $("#errorMsg01").text("旧密码不合法！")
                return false;
            }else {
                $("#errorMsg01").text("");
                return true;
            }

        }
        function checkNewPassword() {
            var newPasswordText=$("#newpassword").val();
            var oldPasswordText=$("#userPassword").val();
            var newPasswordPatt=/^\w{6,12}$/;
            if(newPasswordText==oldPasswordText){
                $("#errorMsg02").text("新密码不能和原密码相同！")
                return false;
            }else {
                if(!newPasswordPatt.test(newPasswordText)){
                    $("#errorMsg02").text("密码由6-12位字母、数字和下划线组成！")
                    return false;
                }else {
                    $("#errorMsg02").text("");
                    return true;
                }
            }

        }
        function confirmPassword() {
            var newPasswordText=$("#newpassword").val();
            var confirmPasswordText=$("#confirmpassword").val();
            if(confirmPasswordText!=newPasswordText){
                $("#errorMsg03").text("确认密码和新密码不一致！")
                return false;
            }else {
                $("#errorMsg03").text("");
                return true;
            }

        }
    </script>

    <script type="application/javascript">
        $(function () {
            $("#btnvcode").one("click",f);

            function f(e) {
                e.preventDefault();
                $.post("/api/user/messageSend", function (data) {
                    (function (e1) {
                        var aaaa = e1.$target;
                        let $this = $(e1.currentTarget).attr("disabled","disabled");
                        let time = 60;
                        let set = setInterval(function () {
                            $this.val("获取验证码(" + time-- +")" );
                            if( time <= 0 ){
                                clearInterval(set);
                                $this.val("获取验证码" ).removeAttr("disabled").one("click",f);
                            }
                        },1000);
                    })(e);
                },"json");
            }
        })

    </script>


</head>

<body class="nav-md">
<div class="container body">
    <div class="main_container">
        <header>
            <!--        每个页面的统一模板-->
            <div style="background-color: deepskyblue;margin: 0px" >
                <div class="row" style="width: 1000px;margin: 0 auto;height: 141px;">
                    <img style="width: 100%;height: 100%" src="/static/img/user_top.png" class="img-responsive">
                </div>
            </div>
            <div class="col-md-3 left_col">
                <div class="left_col scroll-view">
                    <div class="navbar nav_title" style="border: 0;">
                        <a href="#" class="site_title"><i class="fa fa-paw"></i> <span>三下乡信息管理</span></a>
                    </div>

                    <div class="clearfix"></div>

                    <!-- menu profile quick info -->
                    <div class="profile clearfix">
                        <div class="profile_info">
                            <span>Welcome,</span>
                            <h2>保住头发小组</h2>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <!-- /menu profile quick info -->

                    <br />

                    <!-- sidebar menu -->

                    <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                        <div class="menu_section">
                            <ul class="nav side-menu">
                                <li><a><i class="fa fa-home"></i> 统一组织机构管理 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/organization/query_organization.html">组织操作</a></li>
                                        <li><a href="/pages/organization/add_organization.html">增加组织</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-desktop"></i>身份认证 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/certificate/applyCertificate.html">申请认证</a></li>
                                        <li><a href="/pages/certificate/auditCertificate.html">审核认证</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-table"></i> 人事管理 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/personnel/InformationInsert.html">新增部门用户信息</a></li>
                                        <li><a href="/pages/personnel/Infomationupdate.html">修改部门用户信息</a></li>
                                        <li><a href="/pages/personnel/Informationquery.html">查询部门用户信息</a></li>
                                        <li><a href="/pages/personnel/TitleApply.html">申请职称</a></li>
                                        <li><a href="/pages/personnel/TitleAudit.html">审核申请职称</a></li>
                                        <li><a href="/pages/personnel/PermanceApply.html">申请月绩效工资</a></li>
                                        <li><a href="/pages/personnel/PermanceAudit.html">审核月绩效申请</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-bar-chart-o"></i> 财务管理 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/expense/expenseapply.html">申请财务报销</a></li>
                                        <li><a href="/pages/expense/queryExpense.html">查看所有财务报销</a></li>
                                        <li><a href="/pages/expense/queryMyExpense.html">查看个人财务报销</a></li>
                                        <!--                                        <li><a href="/pages/expense/auditExpense.html">报销审核</a></li>-->
                                        <li><a href="/pages/expense/Salary_calculation.html">工资计算</a></li>

                                    </ul>
                                </li>
                                <li><a><i class="fa fa-clone"></i>资产管理 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/Assets/add_assets.html">提交申购资产申请</a></li>
                                        <li><a href="/pages/Assets/query_assets.html">查询资产</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-clone"></i>供应商管理 <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="/pages/supplier/add_supplier.html">登记供应商</a></li>
                                        <li><a href="/pages/supplier/query_supplier.html">查询供应商</a></li>
                                        <li><a href="/pages/supplier/update_supplier.html">修改供应商信息</a></li>
                                        <li><a href="/pages/supplier/delete_supplier.html">删除供应商信息</a></li>
                                        <li><a href="/pages/supplier/add_comment.html">录入供应商评价</a></li>
                                        <li><a href="/pages/supplier/query_comment.html">操作供应商评价</a></li>
                                    </ul>
                                </li>
                            </ul>


                        </div>

                    </div>
                    <!-- /sidebar menu -->

                </div>
            </div>

            <!-- top navigation -->
            <div class="top_nav">
                <div class="nav_menu">
                    <div class="nav toggle">
                        <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                    </div>
                    <nav class="nav navbar-nav" style="float: right;">
                        <ul class=" navbar-right">
                            <li class="nav-item dropdown open" style="padding-left: 15px;">
                                <a href="javascript:;" class="user-profile dropdown-toggle" aria-haspopup="true" id="navbarDropdown" data-toggle="dropdown" aria-expanded="false">
                                    用户中心
                                </a>
                                <div class="dropdown-menu dropdown-usermenu pull-right" aria-labelledby="navbarDropdown">
                                    <a class="dropdown-item" href="/pages/user/update_password.html">修改账号密码</a>
                                    <a class="dropdown-item" href="#">关联组织</a>
                                    <a class="dropdown-item" href="/pages/user/update.html">修改注册信息</a>
                                    <a class="dropdown-item"  href="/pages/user2/login_and_register.html"><i class="fa fa-sign-out pull-right"></i> 退出登录</a>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <!-- /top navigation -->
        </header>
        <!-- page content -->
        <div class="right_col" role="main">
            <div >

                <div class="clearfix"></div>

                <div class="row">
                    <div class="col-md-12 col-sm-12  ">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>修改密码</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div class="form-horizontal form-label-left">
                                    <form id="form_01" class="form-horizontal" action="#" method="post">
                                        <!--存放错误信息-->
                                        <div style="height: 15px;margin-bottom: 13px;text-align: center">
                                            <span id="errorMsg" style="color: red;text-align: center"></span>
                                        </div>

                                        <div class="form-group row">
                                            <label for="msgCode" class="col-sm-5 col-form-label" style="font-size: 18px;text-align: right">验证码:</label>
                                            <div class="col-sm-2">
                                                <input type="text" style="height: 30px;font-size: 15px" class="form-control" id="msgCode" name="msgCode" placeholder="验证码">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="button" style="height: 30px" id="btnvcode" value="获取"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="userPassword" class="col-sm-5 col-form-label" style="font-size: 18px;text-align: right">旧密码:</label>
                                            <div class="col-sm-2">
                                                <input type="password" style="height: 30px;font-size: 15px" class="form-control" id="userPassword" name="userPassword" placeholder="旧密码" oninput="checkUserPassword()"  required>
                                            </div>
                                            <!--存放错误信息-->
                                            <div class="col-sm-3">
                                                <span id="errorMsg01" style="color: red;text-align: center"></span>
                                            </div>
                                        </div>

                                        <div class="form-group row">
                                            <label for="newpassword" class="col-sm-5 col-form-label" style="font-size: 18px;text-align: right">新密码:</label>
                                            <div class="col-sm-2">
                                                <input type="password" style="height: 30px;font-size: 15px" class="form-control" id="newpassword" name="newPasswprd" placeholder="新密码" oninput="checkNewPassword()" onfocus="checkNewPassword()" required>
                                            </div>
                                            <!--存放错误信息-->
                                            <div class="col-sm-3">
                                                <span id="errorMsg02" style="color: red;text-align: center"></span>
                                            </div>
                                        </div>

                                        <div class="form-group row">
                                            <label for="confirmpassword" class="col-sm-5 col-form-label" style="font-size: 18px;text-align: right">确认密码:</label>
                                            <div class="col-sm-2">
                                                <input type="password" style="height: 30px;font-size: 15px" class="form-control" id="confirmpassword" name="confirmpassword" placeholder="确认密码" oninput="confirmPassword()" required>
                                            </div>
                                            <!--存放错误信息-->
                                            <div class="col-sm-3">
                                                <span id="errorMsg03" style="color: red;text-align: center"></span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label  class="col-sm-5 control-label"></label>
                                            <div class="col-sm-2">
                                                <span>
                                                    <button  id="btn_01" class="btn btn-info btn-lg btn-block"  >确认修改</button>
                                                </span>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>
<!-- /page content -->

<!--        这也是模板哦-->
<!-- footer content -->
<footer>
    <div class="pull-right">
        安监局综合信息管理系统 by <a href="#">保住头发小组</a>
    </div>
    <div class="clearfix"></div>
</footer>
<!-- /footer content -->
</div>

<!-- bootstrap-progressbar -->
<script src="/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<!-- iCheck -->
<script src="/vendors/iCheck/icheck.min.js"></script>
<!-- bootstrap-daterangepicker -->
<script src="/vendors/moment/min/moment.min.js"></script>
<script src="/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- bootstrap-wysiwyg -->
<script src="/vendors/bootstrap-wysiwyg/js/bootstrap-wysiwyg.min.js"></script>
<script src="/vendors/jquery.hotkeys/jquery.hotkeys.js"></script>
<script src="/vendors/google-code-prettify/src/prettify.js"></script>
<!-- jQuery Tags Input -->
<script src="/vendors/jquery.tagsinput/src/jquery.tagsinput.js"></script>
<!-- Switchery -->
<script src="/vendors/switchery/dist/switchery.min.js"></script>
<!-- Select2 -->
<script src="/vendors/select2/dist/js/select2.full.min.js"></script>
<!-- Parsley -->
<script src="/vendors/parsleyjs/dist/parsley.min.js"></script>
<!-- Autosize -->
<script src="/vendors/autosize/dist/autosize.min.js"></script>
<!-- jQuery autocomplete -->
<script src="/vendors/devbridge-autocomplete/dist/jquery.autocomplete.min.js"></script>
<!-- starrr -->
<script src="/vendors/starrr/dist/starrr.js"></script>
<!-- FastClick -->
<script src="/vendors/fastclick/lib/fastclick.js"></script>
<!-- NProgress -->
<script src="/vendors/nprogress/nprogress.js"></script>
<!-- Custom Theme Scripts -->
<script src="/build/js/custom.min.js"></script>
<script type="text/javascript" src="http://www.imooc.com/data/jquery.form.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.serializeJSON/2.9.0/jquery.serializejson.js"></script>
<script type="text/javascript" src="//cdn.bootcss.com/handlebars.js/4.0.6/handlebars.js"></script>
<script type="text/javascript" src="http://www.imooc.com/data/jquery.form.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.serializeJSON/2.9.0/jquery.serializejson.js"></script>
</body>
</html>